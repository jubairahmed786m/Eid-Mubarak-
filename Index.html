<script type="text/javascript">
	atOptions = {
		'key' : 'f135f75a4e7e9ddb101b9c762b2080d3',
		'format' : 'iframe',
		'height' : 60,
		'width' : 468,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/f135f75a4e7e9ddb101b9c762b2080d3/invoke.js"></script>

<script type="text/javascript">
	atOptions = {
		'key' : 'f135f75a4e7e9ddb101b9c762b2080d3',
		'format' : 'iframe',
		'height' : 60,
		'width' : 468,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/f135f75a4e7e9ddb101b9c762b2080d3/invoke.js"></script>
<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eid Mubarak Wishes</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu:wght@400;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Merriweather', serif;
            text-align: center;
            background: linear-gradient(135deg, #004225, #006400, #F0E68C);
            color: #fff;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow-x: hidden; 
            overflow-y: auto; 
            position: relative; 
        }

        #fireworksCanvas {
            position: fixed; 
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; 
            pointer-events: none; 
        }

        .content-wrapper {
            position: relative; 
            z-index: 1;
            background-color: rgba(0, 0, 0, 0.45); /* Slightly darker for better contrast */
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.4); /* Enhanced shadow */
            max-width: 500px;
            width: 90%;
            margin-top: 20px; 
            margin-bottom: 20px; 
        }

        #greetingImage {
            max-width: 200px; /* Slightly smaller for balance */
            height: auto;
            border-radius: 10px;
            border: 3px solid #FFD700; 
            margin-bottom: 15px; /* Adjusted margin */
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); /* Enhanced shadow */
        }

        #greetingMessageContainer {
            margin-top: 10px; 
            padding: 10px; 
        }

        #eidGreetingText {
            font-family: 'Noto Nastaliq Urdu', serif; 
            font-size: 3em; 
            color: #FFD700; 
            text-shadow: 2px 2px 5px #000; /* Deeper shadow */
            margin-bottom: 5px;
        }

        #greetingMainText {
            font-size: 1.6em; 
            color: #f5f5f5; /* Slightly brighter white */
            font-weight: bold;
            margin-top: 5px;
        }

        .input-section {
            margin-top: 25px; 
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.12); /* Slightly more opaque */
            border-radius: 8px;
            border: 1px solid rgba(255,215,0,0.6); /* Brighter border */
        }

        .input-section label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #FFD700; 
            font-size: 1.15em; /* Slightly larger */
        }

        .input-section input[type="text"] {
            width: calc(100% - 24px);
            padding: 12px;
            margin-bottom: 20px; /* More space */
            border: 1px solid #FFD700;
            border-radius: 5px;
            box-sizing: border-box;
            background-color: rgba(255,255,255,0.95); /* More opaque */
            color: #333;
            font-size: 1em;
        }
        
        /* Share Button Style */
        #generateLinkButton {
            background-color: #25D366; /* WhatsApp Green */
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 25px; /* Rounded like WhatsApp buttons */
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: inline-flex; /* For aligning icon and text */
            align-items: center;
            justify-content: center;
        }

        #generateLinkButton:hover {
            background-color: #1DAE54; /* Darker WhatsApp Green */
            transform: scale(1.05);
        }
        
        #generateLinkButton .whatsapp-icon {
            width: 20px; /* Adjust size as needed */
            height: 20px;
            margin-right: 8px;
            /* SVG for WhatsApp icon */
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.34 3.43 16.8L2.06 22L7.33 20.62C8.75 21.37 10.35 21.81 12.04 21.81C17.5 21.81 21.95 17.36 21.95 11.91C21.95 6.45 17.5 2 12.04 2M12.04 3.64C16.57 3.64 20.31 7.38 20.31 11.91C20.31 16.44 16.57 20.17 12.04 20.17C10.49 20.17 9.01 19.77 7.73 19.07L7.18 18.76L3.89 19.69L4.84 16.48L4.52 15.9C3.73 14.55 3.29 13.01 3.29 11.91C3.29 7.38 7.02 3.64 12.04 3.64M17.46 14.85C17.26 15.26 16.29 15.78 15.88 15.98C15.47 16.18 14.92 16.22 14.43 16.06C13.95 15.9 12.99 15.56 11.88 14.55C10.51 13.29 9.73 11.78 9.53 11.37C9.33 10.96 9.53 10.66 9.71 10.48C9.87 10.31 10.07 10.08 10.28 9.88C10.42 9.75 10.49 9.62 10.63 9.39C10.77 9.16 10.7 9.01 10.57 8.81C10.43 8.61 9.84 7.17 9.61 6.6C9.37 6.04 9.13 6.11 8.93 6.1C8.74 6.09 8.54 6.09 8.34 6.09C8.14 6.09 7.81 6.17 7.54 6.44C7.27 6.71 6.6 7.31 6.6 8.53C6.6 9.75 7.56 10.91 7.7 11.09C7.84 11.27 9.03 13.22 10.99 14.04C12.56 14.7 13.23 14.95 13.77 15.15C14.53 15.43 15.11 15.39 15.47 15.3C15.88 15.18 16.85 14.66 17.05 14.25C17.26 13.84 17.26 13.5 17.19 13.38C17.12 13.26 16.99 13.18 16.79 13.02C16.59 12.86 15.66 12.37 15.43 12.27C15.19 12.17 15.02 12.14 14.85 12.37C14.69 12.61 14.24 13.13 14.07 13.33C13.91 13.52 13.74 13.56 13.54 13.46C13.34 13.36 12.75 13.16 12.09 12.57C11.24 11.81 10.69 10.93 10.56 10.67C10.43 10.4 10.55 10.24 10.69 10.11C10.82 9.99 10.98 9.82 11.12 9.68C11.27 9.54 11.33 9.44 11.43 9.27C11.53 9.11 11.47 8.97 11.4 8.84C11.34 8.71 10.79 7.32 10.59 6.83C10.39 6.35 10.19 6.38 10.06 6.38C9.92 6.38 9.76 6.38 9.61 6.38L9.61 6.38Z' fill='%23FFFFFF'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
        }
        #buttonText {
            margin-left: 5px; /* Space between icon and text */
        }


        #generatedLinkContainer {
            margin-top: 20px;
            word-break: break-all;
        }
        #generatedLinkContainer p {
            color: #eee;
            font-size: 0.9em; 
        }
        #generatedLink {
            font-family: monospace;
            background-color: rgba(0,0,0,0.6); 
            padding: 10px;
            border: 1px dashed #FFD700;
            display: inline-block;
            color: #fff;
            border-radius: 4px;
            font-size: 0.95em; 
            margin-bottom: 10px; 
        }
        .copy-button {
            background-color: #007f5f; 
            color: white;
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            margin-left: 5px; 
            vertical-align: middle;
            transition: background-color 0.2s ease;
        }
        .copy-button:hover {
            background-color: #006d50;
        }

        .hidden {
            display: none;
        }

        /* Animation for Greeting Text */
        @keyframes fadeInScaleUp {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }
        .animated-greeting {
            animation: fadeInScaleUp 1.5s ease-out forwards;
        }

        @keyframes starShine {
            0%, 100% { text-shadow: 2px 2px 5px #000, 0 0 10px #FFD700, 0 0 20px #FFD700; }
            50% { text-shadow: 2px 2px 5px #000, 0 0 25px #fff, 0 0 35px #FFD700; } /* Brighter shine */
        }
        #eidGreetingText.shine {
            animation: fadeInScaleUp 1.5s ease-out forwards, starShine 1.8s infinite linear 1.5s; /* Faster shine */
        }

    </style>
</head>
<body>
    <canvas id="fireworksCanvas"></canvas>
    
    <div class="content-wrapper">
        <img id="greetingImage" src="laxmi.gif" alt="Festive Animation"> <!-- Yaad se Eid ki GIF laga lein -->

        <div id="greetingMessageContainer" class="hidden animated-greeting">
            <h1 id="eidGreetingText" class="shine"></h1>
            <p id="greetingMainText"></p>
        </div>

        <div class="input-section" id="nameInputSection">
            <label for="nameInput">Apna Naam Likhein:</label>
            <input type="text" id="nameInput" placeholder="Yahan apna naam daalen">
            <button id="generateLinkButton">
                <span class="whatsapp-icon"></span>
                <span id="buttonText">WhatsApp par Share Karein</span>
            </button>
            <div id="generatedLinkContainer" class="hidden">
                <p>Agar share option na aaye, toh yeh link copy karke share karein:</p>
                <div>
                    <code id="generatedLink"></code>
                    <button class="copy-button" id="copyLinkButton">Copy</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Fireworks Code STARTS ---
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        let fireworks = [];
        let particles = [];
        let fireworksInterval;

        function setCanvasSize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        setCanvasSize();


        function Firework(sx, sy, tx, ty) {
            this.x = sx; this.y = sy; this.sx = sx; this.sy = sy;
            this.tx = tx; this.ty = ty;
            this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
            this.distanceTraveled = 0;
            this.coordinates = []; this.coordinateCount = 3;
            while (this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
            this.angle = Math.atan2(ty - sy, tx - sx);
            this.speed = 3; // Increased speed
            this.acceleration = 1.03; 
            this.brightness = Math.random() * 50 + 50; 
            this.targetRadius = 1;
            this.hue = Math.random() * 60 + 90; // Greenish-Yellow-Orange hues
        }

        Firework.prototype.update = function(index) {
            this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]);
            if (this.targetRadius < 10) { this.targetRadius += 0.4; } else { this.targetRadius = 1; } // Larger target radius indicator
            this.speed *= this.acceleration;
            let vx = Math.cos(this.angle) * this.speed;
            let vy = Math.sin(this.angle) * this.speed;
            this.distanceTraveled = Math.sqrt(Math.pow(this.x + vx - this.sx, 2) + Math.pow(this.y + vy - this.sy, 2));
            if (this.distanceTraveled >= this.distanceToTarget) {
                createParticles(this.tx, this.ty, this.hue);
                fireworks.splice(index, 1);
            } else { this.x += vx; this.y += vy; }
        };

        Firework.prototype.draw = function() {
            ctx.beginPath();
            ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y);
            ctx.strokeStyle = `hsl(${this.hue}, 100%, ${this.brightness}%)`;
            ctx.lineWidth = Math.random() * 2.5 + 1.5; // Thicker trail
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(this.tx, this.ty, this.targetRadius, 0, Math.PI * 2);
            ctx.stroke();
        };

        function Particle(x, y, hue) {
            this.x = x; this.y = y;
            this.coordinates = []; this.coordinateCount = 5;
            while (this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
            this.angle = Math.random() * Math.PI * 2;
            this.speed = Math.random() * 15 + 3; // Increased particle speed
            this.friction = 0.95; // Little less friction for longer trails
            this.gravity = 0.7; 
            this.hue = hue + (Math.random() * 70 - 35); 
            this.brightness = Math.random() * 60 + 40; // Brighter particles
            this.alpha = 1;
            this.decay = Math.random() * 0.02 + 0.01; 
            this.lineWidth = Math.random() * 2.5 + 1;
        }

        Particle.prototype.update = function(index) {
            this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]);
            this.speed *= this.friction;
            this.x += Math.cos(this.angle) * this.speed;
            this.y += Math.sin(this.angle) * this.speed + this.gravity;
            this.alpha -= this.decay;
            if (this.alpha <= this.decay) { particles.splice(index, 1); }
        };

        Particle.prototype.draw = function() {
            ctx.beginPath();
            ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y);
            ctx.strokeStyle = `hsla(${this.hue}, 100%, ${this.brightness}%, ${this.alpha})`;
            ctx.lineWidth = this.lineWidth;
            ctx.stroke();
        };

        function createParticles(x, y, hue) {
            let particleCount = Math.random() * 60 + 90; // Increased: 90 to 150 particles
            while (particleCount--) { particles.push(new Particle(x, y, hue)); }
        }
        
        function startFireworks() {
            if (fireworksInterval) clearInterval(fireworksInterval);
            // Launch more initial fireworks quickly
            for(let i=0; i < Math.floor(Math.random()*4)+5; i++) { // Launch 5-8 initial
                 setTimeout(() => {
                    fireworks.push(new Firework(Math.random() * canvas.width, canvas.height, Math.random() * canvas.width, Math.random() * canvas.height / 2));
                }, i * (Math.random()*200+100) ); // Faster initial launch sequence
            }
            // Launch fireworks more frequently
            fireworksInterval = setInterval(() => {
                 fireworks.push(new Firework(Math.random() * canvas.width, canvas.height, Math.random() * canvas.width, Math.random() * canvas.height / 2));
                 // Occasionally launch a double
                 if (Math.random() < 0.3) { // 30% chance of an extra firework
                    setTimeout(() => {
                         fireworks.push(new Firework(Math.random() * canvas.width, canvas.height, Math.random() * canvas.width, Math.random() * canvas.height / 2));
                    }, 200);
                 }
            }, Math.random()*800 + 700); // Launch interval 0.7-1.5s (was 1.5-3s)
        }

        function stopFireworks() { clearInterval(fireworksInterval); }

        let animationFrameId;
        function loop() {
            animationFrameId = requestAnimationFrame(loop);
            ctx.globalCompositeOperation = 'destination-out';
            ctx.fillStyle = 'rgba(0, 0, 0, 0.35)'; // Slightly slower fade for more prominent trails
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.globalCompositeOperation = 'lighter';
            let i = fireworks.length; while (i--) { fireworks[i].draw(); fireworks[i].update(i); }
            i = particles.length; while (i--) { particles[i].draw(); particles[i].update(i); }
        }
        // --- Fireworks Code ENDS ---


        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const senderNameEncoded = urlParams.get('sender');

            const greetingImage = document.getElementById('greetingImage');
            const greetingMessageContainer = document.getElementById('greetingMessageContainer');
            const eidGreetingText = document.getElementById('eidGreetingText');
            const greetingMainText = document.getElementById('greetingMainText');
            
            const nameInputSection = document.getElementById('nameInputSection');
            const nameInput = document.getElementById('nameInput');
            const generateLinkButton = document.getElementById('generateLinkButton');
            const buttonTextElement = document.getElementById('buttonText'); // Get the span for button text
            const generatedLinkContainer = document.getElementById('generatedLinkContainer');
            const generatedLinkElement = document.getElementById('generatedLink');
            const copyLinkButton = document.getElementById('copyLinkButton');

            if (senderNameEncoded) {
                const senderName = decodeURIComponent(senderNameEncoded);
                eidGreetingText.textContent = "ðŸŒ™ Eid Mubarak! ðŸ•Œ";
                greetingMainText.textContent = "From: " + senderName;
                
                greetingMessageContainer.classList.remove('hidden');

                startFireworks(); 
                if (!animationFrameId) loop(); // Start the animation loop if not already running

                nameInputSection.querySelector('label').textContent = "Apna Naam Likhein (taaki aap aage bhej sakein):";
                // Button text remains "WhatsApp par Share Karein"
            } else {
                // Page opened directly. No fireworks initially.
                // If Web Share API is not supported, we might want to change the button text
                if (!navigator.share) {
                    buttonTextElement.textContent = "Link Banayein"; // Change text if no Web Share
                    generateLinkButton.style.backgroundColor = "#FFD700"; // Gold color
                    generateLinkButton.style.color = "#004225"; // Dark green text
                    generateLinkButton.querySelector('.whatsapp-icon').style.display = 'none'; // Hide icon
                }
            }

            generateLinkButton.addEventListener('click', async function() { 
                const currentName = nameInput.value.trim();
                if (currentName === "") {
                    alert("Kripya apna naam daalein!");
                    return;
                }
                
                let baseUrl = window.location.origin + window.location.pathname;
                const newLink = `${baseUrl}?sender=${encodeURIComponent(currentName)}`;
                
                generatedLinkElement.textContent = newLink;
                generatedLinkContainer.classList.remove('hidden');

                const shareData = {
                    title: `ðŸŒ™ Eid Mubarak from ${currentName}!`,
                    text: `Assalamu Alaikum! ${currentName} ki taraf se aapko Eid ki bahut bahut Mubarakbad! ðŸ•Œâœ¨\nIs khas paigham ko dekhne ke liye click karein:`,
                    url: newLink
                };

                if (navigator.share) {
                    try {
                        await navigator.share(shareData);
                        console.log('Link shared successfully via Web Share API!');
                    } catch (error) {
                        console.warn('Web Share API error:', error);
                        if (error.name !== 'AbortError') { 
                             alert("Share karne mein kuchh samasya hui. Link neeche dikhaya gaya hai, kripya ise copy karke share karein.");
                        } else {
                            console.log('Share cancelled by user.');
    